<!DOCTYPE html>
<html>
    <head>
        <title>图片lazyload</title>
        <style>
            img {
                display: block;
                width: 100%;
            }
        </style>
    </head>
    <body>
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://img.alicdn.com/tps/i4/TB1Njg2bjuhSKJjSspmSuwQDpXa.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i2/2958596375/TB10kTSRVXXXXajXFXXXXXXXXXX_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i1/TB11mpAJVXXXXbtXVXXXXXXXXXX_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i4/TB11DvzQXXXXXbQaFXXXXXXXXXX_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i3/2807304908/TB1n.VeXm7PL1JjSZFHXXcciXXa_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i2/TB1EGMPPFXXXXc2XXXXXXXXXXXX_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i3/3310597052/TB1o4hQSpXXXXbraXXXXXXXXXXX_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i4/1891815962/TB1zo5hfeEJL1JjSZFGXXa6OXXa_!!2-item_pic.png">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i1/TB1sdj1RFXXXXXEXVXXXXXXXXXX_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i2/TB1uLbcPFXXXXchXFXXXXXXXXXX_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i3/3055781561/TB1fqL6b8RRMKJjSZPhXXcZoVXa_!!0-item_pic.jpg">
        <img src="https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif" data-src="https://gw.alicdn.com/bao/uploaded/i2/1113314630/TB1QLExhfNNTKJjSspcXXb4KVXa_!!0-item_pic.jpg">
        <script>
            function throttle(fn, delay, atleast) {
                let timeout = null
                let startTime = new Date()
                return function() {
                    const curTime = new Date()
                    clearTimeout(timeout)
                    if (curTime - startTime >= atleast) {
                        fn()
                        startTime = curTime
                    } else {
                        timeout = setTimeout(fn, delay)
                    }
                }
            }
            function lazyload() {
                const images = document.getElementsByTagName('img')
                const len = images.length
                let n = 0
                return function() {
                    const seeHeight = document.documentElement.clientHeight
                    const scrollTop = document.documentElement.scrollTop || document.body.scrollTop
                    for (let i = n; i < len; i++) {
                        if (images[i].offsetTop < seeHeight + scrollTop) {
                            if (images[i].getAttribute('src') === 'https://8.url.cn/edu/lego_modules/edu-ui/0.0.1/img/nohash/loading.gif') {
                                images[i].src = images[i].getAttribute('data-src')
                            }
                            n = n + 1
                        }
                    }
                }
            }
            var loadImages = lazyload()
            window.onload = function () {
                loadImages()
                window.addEventListener('scroll', throttle(loadImages, 500, 1000), false)
                // throttle(loadImages, 500, 1000) 的意思是 loadImages 函数至少 1500 ms 内执行一次，至多 500 ms 内执行一次
            }
        </script>
    </body>
</html>
